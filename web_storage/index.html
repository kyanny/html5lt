<!DOCTYPE html>
<html><head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>Web Storage</title>
  <meta name="author" content="kyanny">
  <script type="text/javascript" src="lib/jquery.js"></script>
  <script type="text/javascript" src="lib/nerine.js"></script>
  <link rel="stylesheet" type="text/css" href="lib/nerine.css">
  <link rel="stylesheet" type="text/css" href="cooldemo.css">
</head><body>
<article>

<section>
  <h1>Web Storage</h1>
</section>

<section>
  <h2>Web Storage</h2>
  <ul>
    <li effect="fade">単純な Key-Value ストア</li>
    <li effect="fade">オリジン (ドメイン)による制約</li>
    <li effect="fade">a.example.com と b.example.com で別</li>
    <li effect="fade">localStorage</li>
    <li effect="fade">sessionStorage (ウィンドウ別)</li>
  </ul>
</section>

<section>
  <h2>Code</h2>
  <div effect="fade"><pre>
  localStorage.foo = "FOO";
  localStorage['bar'] = "BAR";

  // Javascript オブジェクトは直接保存できない?
  localStorage.baz = JSON.stringify({key: "baz", value: "BAZ"});
  var baz = JSON.parse(localStorage.baz);

  for (var i=0; i&lt;localStorage.length; i++){
    var key = localStorage[i];
    var value = localStorage.getItem(key);
    localStorage.removeItem(key);
  }

  localStorage.clear();
  </pre></div>
</section>

<section>
  <h2>Storage Event</h2>
  <ul>
    <li effect="fade">ストレージのデータが更新されたとき window オブジェクトに通知されるイベント</li>
    <li effect="fade">「PUT されたらページを更新」とか</li>
  </ul>
  <div effect="fade"><pre>
  window.addEventListener('storage', function(event){
    console.log(event.key);
    console.log(event.oldValue);
    console.log(event.newValue);
  });
  </pre></div>
</section>

<section>
  <h2>まとめ</h2>
  <ul>
    <li effect="fade">使いやすい & わかりやすい</li>
    <li effect="fade">XHR の結果キャッシュによいかも</li>
    <li effect="fade">アフィリエイトIDの保持とか</li>
  </ul>
</section>

<section class="last">
  <p>以上</p>
</section>

</article>
</body></html>